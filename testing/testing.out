# ETHAN CHEN, BANSHAREE IREEN, JEFFREY JIANG
# testing.sh - integration testing for sudoku module

touch ../tables/easyTable.txt
touch ../tables/hardTable.txt
touch ../tables/valgrindTable.txt
touch ../tables/easy16.txt
touch ../tables/hard16.txt


# VALID TESTS
# test 1:creating a board on easy mode
../sudoku/sudoku create easy > ../tables/easyTable.txt

# test 2: creating a board on hard mode
../sudoku/sudoku create hard > ../tables/hardTable.txt

# test 3: solving the board made by test 1
../sudoku/sudoku solve easy < ../tables/easyTable.txt
Original Board: 
----------------------------------
<<<<<<< HEAD
|  6  0  3 |  0  0  5 |  2  0  7 | 
|  0  1  5 |  0  4  7 |  0  0  0 | 
|  0  0  7 |  3  8  0 |  0  1  0 | 
----------------------------------
|  0  0  0 |  0  6  0 |  4  7  2 | 
|  4  2  6 |  0  0  0 |  0  5  8 | 
|  0  0  8 |  4  2  0 |  0  3  1 | 
----------------------------------
|  5  0  4 |  7  9  1 |  0  0  0 | 
|  0  0  0 |  6  0  0 |  1  0  0 | 
|  0  0  9 |  0  0  0 |  7  0  4 | 
----------------------------------
Solved: 
----------------------------------
|  6  8  3 |  9  1  5 |  2  4  7 | 
|  9  1  5 |  2  4  7 |  3  8  6 | 
|  2  4  7 |  3  8  6 |  5  1  9 | 
----------------------------------
|  3  9  1 |  5  6  8 |  4  7  2 | 
|  4  2  6 |  1  7  3 |  9  5  8 | 
|  7  5  8 |  4  2  9 |  6  3  1 | 
----------------------------------
|  5  6  4 |  7  9  1 |  8  2  3 | 
|  8  7  2 |  6  3  4 |  1  9  5 | 
|  1  3  9 |  8  5  2 |  7  6  4 | 
=======
|  8  0  6 |  7  9  4 |  1  2  3 | 
|  0  0  0 |  2  0  0 |  0  0  0 | 
|  0  1  2 |  0  0  8 |  0  9  7 | 
----------------------------------
|  0  0  4 |  0  0  3 |  6  0  8 | 
|  0  0  0 |  8  0  0 |  4  7  9 | 
|  0  0  8 |  4  7  0 |  3  1  0 | 
----------------------------------
|  9  8  0 |  0  0  0 |  0  3  0 | 
|  6  0  0 |  0  3  2 |  0  0  0 | 
|  0  2  0 |  0  0  7 |  9  0  4 | 
----------------------------------
Solved: 
----------------------------------
|  8  5  6 |  7  9  4 |  1  2  3 | 
|  3  7  9 |  2  1  5 |  8  4  6 | 
|  4  1  2 |  3  6  8 |  5  9  7 | 
----------------------------------
|  7  9  4 |  1  2  3 |  6  5  8 | 
|  2  3  1 |  8  5  6 |  4  7  9 | 
|  5  6  8 |  4  7  9 |  3  1  2 | 
----------------------------------
|  9  8  7 |  6  4  1 |  2  3  5 | 
|  6  4  5 |  9  3  2 |  7  8  1 | 
|  1  2  3 |  5  8  7 |  9  6  4 | 
>>>>>>> b79d130fc1e33faf6015732f8c71d03605f8e077
----------------------------------

# test 4: solving the board made by test 2
../sudoku/sudoku solve hard < ../tables/easyTable.txt
Original Board: 
----------------------------------
<<<<<<< HEAD
|  6  0  3 |  0  0  5 |  2  0  7 | 
|  0  1  5 |  0  4  7 |  0  0  0 | 
|  0  0  7 |  3  8  0 |  0  1  0 | 
----------------------------------
|  0  0  0 |  0  6  0 |  4  7  2 | 
|  4  2  6 |  0  0  0 |  0  5  8 | 
|  0  0  8 |  4  2  0 |  0  3  1 | 
----------------------------------
|  5  0  4 |  7  9  1 |  0  0  0 | 
|  0  0  0 |  6  0  0 |  1  0  0 | 
|  0  0  9 |  0  0  0 |  7  0  4 | 
----------------------------------
Solved: 
----------------------------------
|  6  8  3 |  9  1  5 |  2  4  7 | 
|  9  1  5 |  2  4  7 |  3  8  6 | 
|  2  4  7 |  3  8  6 |  5  1  9 | 
----------------------------------
|  3  9  1 |  5  6  8 |  4  7  2 | 
|  4  2  6 |  1  7  3 |  9  5  8 | 
|  7  5  8 |  4  2  9 |  6  3  1 | 
----------------------------------
|  5  6  4 |  7  9  1 |  8  2  3 | 
|  8  7  2 |  6  3  4 |  1  9  5 | 
|  1  3  9 |  8  5  2 |  7  6  4 | 
=======
|  8  0  6 |  7  9  4 |  1  2  3 | 
|  0  0  0 |  2  0  0 |  0  0  0 | 
|  0  1  2 |  0  0  8 |  0  9  7 | 
----------------------------------
|  0  0  4 |  0  0  3 |  6  0  8 | 
|  0  0  0 |  8  0  0 |  4  7  9 | 
|  0  0  8 |  4  7  0 |  3  1  0 | 
----------------------------------
|  9  8  0 |  0  0  0 |  0  3  0 | 
|  6  0  0 |  0  3  2 |  0  0  0 | 
|  0  2  0 |  0  0  7 |  9  0  4 | 
----------------------------------
Solved: 
----------------------------------
|  8  5  6 |  7  9  4 |  1  2  3 | 
|  3  7  9 |  2  1  5 |  8  4  6 | 
|  4  1  2 |  3  6  8 |  5  9  7 | 
----------------------------------
|  7  9  4 |  1  2  3 |  6  5  8 | 
|  2  3  1 |  8  5  6 |  4  7  9 | 
|  5  6  8 |  4  7  9 |  3  1  2 | 
----------------------------------
|  9  8  7 |  6  4  1 |  2  3  5 | 
|  6  4  5 |  9  3  2 |  7  8  1 | 
|  1  2  3 |  5  8  7 |  9  6  4 | 
>>>>>>> b79d130fc1e33faf6015732f8c71d03605f8e077
----------------------------------

# test 5: creating 16x16 on easy board 
../sudoku/sudoku create easy 16 > ../tables/easy16.txt

# test 6: creating 16x16 board on hard mode
../sudoku/sudoku create hard 16 > ../tables/hard16.txt

# test 7: solving the board made by test 5
../sudoku/sudoku solve easy 16 < ../tables/easy16.txt
Original Board: 
---------------------------------------------------------
|  0  0  9  0 |  0  0  6  0 |  1  0  4  0 |  0 11 10 16 | 
|  0  0  1  2 |  3 13  9  7 | 15 16 10 11 | 14 12  0  5 | 
|  5 15 11 12 |  1 10  0 16 |  8  0  6 14 |  9  2 13  0 | 
|  0  0 14  0 | 11 15  0  2 | 13  0  0  9 |  0  0  0  1 | 
---------------------------------------------------------
| 10  9  8 15 |  5  0 12  3 |  0  1  7  2 | 11 14 16 13 | 
|  2  0  0  3 |  9  1  7  4 |  0 11  0  0 |  0 15  8  0 | 
|  7 11 13  0 |  0  2 16 14 |  0  0 12  8 |  4  5  6  9 | 
| 16 12  0  0 |  0 11 13 10 |  5  6  0 15 |  3  0  1  2 | 
---------------------------------------------------------
|  1  6  0  8 |  4  5  0 15 |  9 13 16  7 | 10  0 11  0 | 
| 13  0  3  0 | 10  0  0  6 | 12 14  0  4 |  0  0  5 15 | 
| 15  4  0  0 | 14 16 11  0 |  6  5  1  0 | 13  0 12  0 | 
|  0  0 16  5 |  0  7  0 12 |  0 15  8 10 |  0  1  0  0 | 
---------------------------------------------------------
| 12  2 15  0 |  6  3  8  0 | 10  0  0 16 |  0  0 14 11 | 
|  8  0  5  4 |  0 12 15 11 |  0  9 13  1 | 16  0  2  6 | 
| 14  1  7  6 | 16  0  0  0 |  0  0  2  0 |  5  0 15  8 | 
|  9  0 10 11 |  2  4 14  5 |  7  8  0  6 |  1 13  3 12 | 
---------------------------------------------------------
Solved: 
---------------------------------------------------------
|  3 13  9  7 | 12 14  6  8 |  1  2  4  5 | 15 11 10 16 | 
|  6  8  1  2 |  3 13  9  7 | 15 16 10 11 | 14 12  4  5 | 
|  5 15 11 12 |  1 10  4 16 |  8  7  6 14 |  9  2 13  3 | 
|  4 10 14 16 | 11 15  5  2 | 13 12  3  9 |  8  6  7  1 | 
---------------------------------------------------------
| 10  9  8 15 |  5  6 12  3 |  4  1  7  2 | 11 14 16 13 | 
|  2  5  6  3 |  9  1  7  4 | 16 11 14 13 | 12 15  8 10 | 
|  7 11 13  1 | 15  2 16 14 |  3 10 12  8 |  4  5  6  9 | 
| 16 12  4 14 |  8 11 13 10 |  5  6  9 15 |  3  7  1  2 | 
---------------------------------------------------------
|  1  6 12  8 |  4  5  2 15 |  9 13 16  7 | 10  3 11 14 | 
| 13  7  3  9 | 10  8  1  6 | 12 14 11  4 |  2 16  5 15 | 
| 15  4  2 10 | 14 16 11  9 |  6  5  1  3 | 13  8 12  7 | 
| 11 14 16  5 | 13  7  3 12 |  2 15  8 10 |  6  1  9  4 | 
---------------------------------------------------------
| 12  2 15 13 |  6  3  8  1 | 10  4  5 16 |  7  9 14 11 | 
|  8  3  5  4 |  7 12 15 11 | 14  9 13  1 | 16 10  2  6 | 
| 14  1  7  6 | 16  9 10 13 | 11  3  2 12 |  5  4 15  8 | 
|  9 16 10 11 |  2  4 14  5 |  7  8 15  6 |  1 13  3 12 | 
---------------------------------------------------------

# test 8: solving the board made by test 6
../sudoku/sudoku solve hard 16 < ../tables/hard16.txt
Original Board: 
---------------------------------------------------------
|  2 12  4  3 |  7  0 11  0 |  6  0  0 14 |  0  0  0 16 | 
|  0  0  0  0 |  0  0  2 12 |  8  0  0 13 |  0  0  4  3 | 
|  0  0  7 14 |  5  0  0  0 | 12  0  4  3 |  2  0 15  0 | 
|  8  0 13 16 |  0  0  3  0 | 15  0  7  9 |  0  1 12 11 | 
---------------------------------------------------------
| 11  6  5  0 |  0  4 10  0 | 14  0  2  7 |  0  0  0  0 | 
|  3  0  0 10 |  0  1  0  0 |  0  4  9 12 | 15  2  0  8 | 
|  0  0 14  0 |  2  0  0  0 | 13  6  3 16 |  4  0  1  0 | 
|  9 13  0  0 |  6 16  0  0 | 10  8  0  0 |  0  5  0 12 | 
---------------------------------------------------------
|  6  4 10  5 | 11  0 16  0 |  1  3  0  0 |  0  0  0  0 | 
|  0  0  0  0 | 15  9  6 14 | 16 12  0  0 |  0  0  5  4 | 
|  0  9  0  0 |  4  2  0 13 |  0  5  0  0 | 12 15  3  0 | 
|  0 15  1 12 |  3  8  0  0 |  0  0  6  0 | 11 13  0  7 | 
---------------------------------------------------------
|  4  3 15  2 |  0 11  0  0 |  0 14  0  6 |  0  7  0  5 | 
|  0  0  6  0 |  0  0  0  0 |  3 13 12  1 |  0  4 14  2 | 
|  5  1  0  7 |  9 14  0  6 |  2  0  8  0 | 16  3 11  0 | 
| 13 14  0  0 | 16  3  4  0 |  0  0  0  5 |  6  0  0  1 | 
---------------------------------------------------------
Solved: 
---------------------------------------------------------
|  2 12  4  3 |  7 15 11  9 |  6  1 10 14 |  5  8 13 16 | 
| 15 11  9  6 |  1 10  2 12 |  8 16  5 13 |  7 14  4  3 | 
|  1 10  7 14 |  5 13  8 16 | 12 11  4  3 |  2  6 15  9 | 
|  8  5 13 16 | 14  6  3  4 | 15  2  7  9 | 10  1 12 11 | 
---------------------------------------------------------
| 11  6  5  1 | 12  4 10  8 | 14 15  2  7 |  3 16  9 13 | 
|  3  7 16 10 | 13  1 14 11 |  5  4  9 12 | 15  2  6  8 | 
| 12  8 14 15 |  2  7  9  5 | 13  6  3 16 |  4 11  1 10 | 
|  9 13  2  4 |  6 16 15  3 | 10  8  1 11 | 14  5  7 12 | 
---------------------------------------------------------
|  6  4 10  5 | 11 12 16  7 |  1  3 13 15 |  8  9  2 14 | 
|  7  2  3 13 | 15  9  6 14 | 16 12 11  8 |  1 10  5  4 | 
| 16  9 11  8 |  4  2  1 13 |  7  5 14 10 | 12 15  3  6 | 
| 14 15  1 12 |  3  8  5 10 |  4  9  6  2 | 11 13 16  7 | 
---------------------------------------------------------
|  4  3 15  2 | 10 11 12  1 |  9 14 16  6 | 13  7  8  5 | 
| 10 16  6 11 |  8  5  7 15 |  3 13 12  1 |  9  4 14  2 | 
|  5  1 12  7 |  9 14 13  6 |  2 10  8  4 | 16  3 11 15 | 
| 13 14  8  9 | 16  3  4  2 | 11  7 15  5 |  6 12 10  1 | 
---------------------------------------------------------


# INVALID INPUTS

# invalid mode
../sudoku/sudoku wrong easy
Please select a valid mode: create or solve.

# invalid difficulty
../sudoku/sudoku create wrong
Please select a valid level of difficulty: easy or hard.

# 3rd argument can only be dimension
../sudoku/sudoku create easy nonIntArg
Dimension must be a 4, 9, or 16.

# using invalid dimension
../sudoku/sudoku solve hard 10 
Dimension must be a 4, 9, or 16.

# using invalid board
../sudoku/sudoku solve easy < ../tables/invalidTable.txt
Error: format of input file is incorrect

# SOLVABILITY
# trying to solve a known unsolvable board
../sudoku/sudoku solve easy < ../tables/unsolvableTable.txt
5 already exists in row
5 already exists in col
5 already exists in box
Invalid board
Could not solve board
Original Board: 
5 1 6 8 4 5 7 3 2 
3 0 7 6 0 5 0 0 0 
8 0 9 7 0 0 0 6 5 
1 3 5 0 6 0 9 0 7 
4 7 2 5 9 1 0 0 6 
9 6 8 3 7 0 0 5 0 
2 5 3 1 8 6 0 7 4 
6 8 4 2 0 7 5 0 0 
7 9 1 0 5 0 6 0 8 

# VALGRIND TESTS
# checking for memory leaks on create mode
valgrind --leak-check=full --show-leak-kinds=all ../sudoku/sudoku create easy > ../tables/valgrindTable.txt
==4437== Memcheck, a memory error detector
==4437== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==4437== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info
==4437== Command: ../sudoku/sudoku create easy
==4437== 
==4437== 
==4437== HEAP SUMMARY:
==4437==     in use at exit: 510 bytes in 33 blocks
==4437==   total heap usage: 4,185 allocs, 4,152 frees, 96,882 bytes allocated
==4437== 
==4437== 72 bytes in 3 blocks are indirectly lost in loss record 1 of 7
==4437==    at 0x4C33B25: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==4437==    by 0x109452: generate (creator.c:103)
==4437==    by 0x109118: generateUniqueTable (creator.c:28)
==4437==    by 0x108FAE: createTable (sudoku.c:121)
==4437==    by 0x108F40: main (sudoku.c:95)
==4437== 
==4437== 90 bytes in 9 blocks are indirectly lost in loss record 2 of 7
==4437==    at 0x4C33B25: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==4437==    by 0x10937C: generate (creator.c:92)
==4437==    by 0x109118: generateUniqueTable (creator.c:28)
==4437==    by 0x108FAE: createTable (sudoku.c:121)
==4437==    by 0x108F40: main (sudoku.c:95)
==4437== 
==4437== 90 bytes in 9 blocks are indirectly lost in loss record 3 of 7
==4437==    at 0x4C33B25: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==4437==    by 0x1093EA: generate (creator.c:98)
==4437==    by 0x109118: generateUniqueTable (creator.c:28)
==4437==    by 0x108FAE: createTable (sudoku.c:121)
==4437==    by 0x108F40: main (sudoku.c:95)
==4437== 
==4437== 90 bytes in 9 blocks are indirectly lost in loss record 4 of 7
==4437==    at 0x4C33B25: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==4437==    by 0x1094A5: generate (creator.c:105)
==4437==    by 0x109118: generateUniqueTable (creator.c:28)
==4437==    by 0x108FAE: createTable (sudoku.c:121)
==4437==    by 0x108F40: main (sudoku.c:95)
==4437== 
==4437== 162 (72 direct, 90 indirect) bytes in 1 blocks are definitely lost in loss record 5 of 7
==4437==    at 0x4C33B25: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==4437==    by 0x10933B: generate (creator.c:90)
==4437==    by 0x109118: generateUniqueTable (creator.c:28)
==4437==    by 0x108FAE: createTable (sudoku.c:121)
==4437==    by 0x108F40: main (sudoku.c:95)
==4437== 
==4437== 162 (72 direct, 90 indirect) bytes in 1 blocks are definitely lost in loss record 6 of 7
==4437==    at 0x4C33B25: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==4437==    by 0x1093A9: generate (creator.c:96)
==4437==    by 0x109118: generateUniqueTable (creator.c:28)
==4437==    by 0x108FAE: createTable (sudoku.c:121)
==4437==    by 0x108F40: main (sudoku.c:95)
==4437== 
==4437== 186 (24 direct, 162 indirect) bytes in 1 blocks are definitely lost in loss record 7 of 7
==4437==    at 0x4C33B25: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==4437==    by 0x109414: generate (creator.c:101)
==4437==    by 0x109118: generateUniqueTable (creator.c:28)
==4437==    by 0x108FAE: createTable (sudoku.c:121)
==4437==    by 0x108F40: main (sudoku.c:95)
==4437== 
==4437== LEAK SUMMARY:
==4437==    definitely lost: 168 bytes in 3 blocks
==4437==    indirectly lost: 342 bytes in 30 blocks
==4437==      possibly lost: 0 bytes in 0 blocks
==4437==    still reachable: 0 bytes in 0 blocks
==4437==         suppressed: 0 bytes in 0 blocks
==4437== 
==4437== For counts of detected and suppressed errors, rerun with: -v
==4437== ERROR SUMMARY: 3 errors from 3 contexts (suppressed: 0 from 0)

# checking for memory leaks on solve mode
valgrind --leak-check=full --show-leak-kinds=all ../sudoku/sudoku solve easy < ../tables/valgrindTable.txt
==4450== Memcheck, a memory error detector
==4450== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==4450== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info
==4450== Command: ../sudoku/sudoku solve easy
==4450== 
Original Board: 
----------------------------------
|  6  0  0 |  0  0  0 |  1  0  8 | 
|  1  3  0 |  0  8  0 |  6  7  5 | 
|  0  0  8 |  1  0  6 |  4  9  3 | 
----------------------------------
|  3  9  0 |  2  6  0 |  5  8  1 | 
|  5  0  0 |  0  3  0 |  0  0  4 | 
|  0  0  0 |  9  0  5 |  0  0  7 | 
----------------------------------
|  0  0  0 |  5  0  3 |  0  0  0 | 
|  0  2  0 |  0  0  0 |  0  5  0 | 
|  0  5  0 |  6  7  0 |  3  4  0 | 
----------------------------------
Solved: 
----------------------------------
|  6  4  5 |  3  9  7 |  1  2  8 | 
|  1  3  9 |  4  8  2 |  6  7  5 | 
|  2  7  8 |  1  5  6 |  4  9  3 | 
----------------------------------
|  3  9  7 |  2  6  4 |  5  8  1 | 
|  5  1  2 |  7  3  8 |  9  6  4 | 
|  4  8  6 |  9  1  5 |  2  3  7 | 
----------------------------------
|  7  6  4 |  5  2  3 |  8  1  9 | 
|  9  2  3 |  8  4  1 |  7  5  6 | 
|  8  5  1 |  6  7  9 |  3  4  2 | 
----------------------------------
==4450== 
==4450== HEAP SUMMARY:
==4450==     in use at exit: 0 bytes in 0 blocks
==4450==   total heap usage: 47 allocs, 47 frees, 17,338 bytes allocated
==4450== 
==4450== All heap blocks were freed -- no leaks are possible
==4450== 
==4450== For counts of detected and suppressed errors, rerun with: -v
==4450== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)

exit 0
