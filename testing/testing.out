# ETHAN CHEN, BANSHAREE IREEN, JEFFREY JIANG
# testing.sh - integration testing for sudoku module

touch ../tables/easyTable.txt
touch ../tables/hardTable.txt
touch ../tables/valgrindTable.txt
touch ../tables/easy16.txt
touch ../tables/hard16.txt
touch ../tables/hard4.txt

# VALID TESTS
# test 1: creating 9x9 board on easy mode
../sudoku/sudoku create easy > ../tables/easyTable.txt

# test 2: creating 9x9 board on hard mode
../sudoku/sudoku create hard > ../tables/hardTable.txt

# test 3: solving the board made by test 1
../sudoku/sudoku solve easy < ../tables/easyTable.txt
Original Board: 
----------------------------------
|  3  0  4 |  0  0  0 |  2  6  9 | 
|  0  0  1 |  0  6  0 |  0  4  3 | 
|  0  6  9 |  0  5  4 |  0  0  1 | 
----------------------------------
|  5  0  0 |  0  0  8 |  6  0  0 | 
|  0  0  0 |  6  9  0 |  4  0  7 | 
|  9  0  0 |  0  7  0 |  0  0  0 | 
----------------------------------
|  0  0  0 |  1  3  0 |  0  2  6 | 
|  1  2  3 |  0  0  0 |  8  7  0 | 
|  0  9  5 |  8  2  0 |  0  1  0 | 
----------------------------------
Solved: 
----------------------------------
|  3  5  4 |  7  8  1 |  2  6  9 | 
|  7  8  1 |  2  6  9 |  5  4  3 | 
|  2  6  9 |  3  5  4 |  7  8  1 | 
----------------------------------
|  5  3  7 |  4  1  8 |  6  9  2 | 
|  8  1  2 |  6  9  3 |  4  5  7 | 
|  9  4  6 |  5  7  2 |  1  3  8 | 
----------------------------------
|  4  7  8 |  1  3  5 |  9  2  6 | 
|  1  2  3 |  9  4  6 |  8  7  5 | 
|  6  9  5 |  8  2  7 |  3  1  4 | 
----------------------------------

# test 4: solving the board made by test 2
../sudoku/sudoku solve hard < ../tables/easyTable.txt
Original Board: 
----------------------------------
|  3  0  4 |  0  0  0 |  2  6  9 | 
|  0  0  1 |  0  6  0 |  0  4  3 | 
|  0  6  9 |  0  5  4 |  0  0  1 | 
----------------------------------
|  5  0  0 |  0  0  8 |  6  0  0 | 
|  0  0  0 |  6  9  0 |  4  0  7 | 
|  9  0  0 |  0  7  0 |  0  0  0 | 
----------------------------------
|  0  0  0 |  1  3  0 |  0  2  6 | 
|  1  2  3 |  0  0  0 |  8  7  0 | 
|  0  9  5 |  8  2  0 |  0  1  0 | 
----------------------------------
Solved: 
----------------------------------
|  3  5  4 |  7  8  1 |  2  6  9 | 
|  7  8  1 |  2  6  9 |  5  4  3 | 
|  2  6  9 |  3  5  4 |  7  8  1 | 
----------------------------------
|  5  3  7 |  4  1  8 |  6  9  2 | 
|  8  1  2 |  6  9  3 |  4  5  7 | 
|  9  4  6 |  5  7  2 |  1  3  8 | 
----------------------------------
|  4  7  8 |  1  3  5 |  9  2  6 | 
|  1  2  3 |  9  4  6 |  8  7  5 | 
|  6  9  5 |  8  2  7 |  3  1  4 | 
----------------------------------

# test 5: creating 16x16 on easy board 
../sudoku/sudoku create easy 16 > ../tables/easy16.txt

# test 6: creating 16x16 board on hard mode
../sudoku/sudoku create hard 16 > ../tables/hard16.txt

# test 7: solving the board made by test 5
../sudoku/sudoku solve easy 16 < ../tables/easy16.txt
Original Board: 
---------------------------------------------------------
|  7 13  0  0 |  4  5  0  0 |  0  0  3  9 |  0  0 16 12 | 
|  0  2  3  8 | 15 10 13  6 |  0 16  0  0 |  0  5  0  4 | 
|  4  0 14  9 |  0  0  0  0 | 10  0  6 15 |  3  0  8  1 | 
| 12  0 16  0 |  0  3  8  0 |  4 13  0  1 |  0  0  0 10 | 
---------------------------------------------------------
|  0  8  7 15 |  0 12 10  0 | 16  0  2 14 |  0 11  1  5 | 
|  0  9 11 12 |  0  0  6 15 |  3  0  1  4 |  0 10 14  0 | 
|  0  0  0  0 | 11 14  0  0 |  0 15 10  8 |  4 16  7  0 | 
| 14 10  0  0 | 16  2  5  0 | 11  9  0  7 |  6  3  0 15 | 
---------------------------------------------------------
|  0  4  8 13 |  7  6  9  0 | 15  0  0  5 |  2  1  3  0 | 
| 11  7  6  5 | 14 15  0 12 | 13  0  9  2 | 10  0  0 16 | 
|  3  0  9 16 | 10  1  2 13 |  8 14  4  0 | 15  7  0  6 | 
| 15  1  0 14 |  0 16  0  0 |  0  0  7  0 |  0 12 11  9 | 
---------------------------------------------------------
|  0  0 13  0 | 12  0  0 14 |  9  2 15  0 |  0  4  0  7 | 
|  0  6  0  0 |  5  0 15  0 |  0  4  0  0 |  0  0  0  0 | 
|  9 14 12  0 |  1 13  0  2 |  0 11  8 10 |  0  0  6  0 | 
|  2  0  1  0 |  0  4  7  0 |  0  0  0 16 | 12  9 13  8 | 
---------------------------------------------------------
Solved: 
---------------------------------------------------------
|  7 13 15 10 |  4  5 14  1 |  2  8  3  9 | 11  6 16 12 | 
|  1  2  3  8 | 15 10 13  6 | 14 16 11 12 |  7  5  9  4 | 
|  4  5 14  9 |  2 11 12 16 | 10  7  6 15 |  3 13  8  1 | 
| 12 11 16  6 |  9  3  8  7 |  4 13  5  1 | 14  2 15 10 | 
---------------------------------------------------------
| 13  8  7 15 |  3 12 10  4 | 16  6  2 14 |  9 11  1  5 | 
| 16  9 11 12 | 13  7  6 15 |  3  5  1  4 |  8 10 14  2 | 
|  6  3  5  2 | 11 14  1  9 | 12 15 10  8 |  4 16  7 13 | 
| 14 10  4  1 | 16  2  5  8 | 11  9 13  7 |  6  3 12 15 | 
---------------------------------------------------------
| 10  4  8 13 |  7  6  9 11 | 15 12 16  5 |  2  1  3 14 | 
| 11  7  6  5 | 14 15  3 12 | 13  1  9  2 | 10  8  4 16 | 
|  3 12  9 16 | 10  1  2 13 |  8 14  4 11 | 15  7  5  6 | 
| 15  1  2 14 |  8 16  4  5 |  6 10  7  3 | 13 12 11  9 | 
---------------------------------------------------------
|  5 16 13  3 | 12  8 11 14 |  9  2 15  6 |  1  4 10  7 | 
|  8  6 10  7 |  5  9 15  3 |  1  4 12 13 | 16 14  2 11 | 
|  9 14 12  4 |  1 13 16  2 |  7 11  8 10 |  5 15  6  3 | 
|  2 15  1 11 |  6  4  7 10 |  5  3 14 16 | 12  9 13  8 | 
---------------------------------------------------------

# test 8: solving the board made by test 6
../sudoku/sudoku solve hard 16 < ../tables/hard16.txt
Original Board: 
---------------------------------------------------------
|  0  9  8  7 |  0  6 13  3 |  0 15  0  0 |  0  1  0  0 | 
|  0  0 11  4 |  7  0  0  0 |  0  0  1 14 | 10  6  0 15 | 
| 10  0  0  0 |  0  0  0  0 |  9  7  0 13 |  0  0  0  0 | 
|  0  0  0  0 |  0 15  0  0 |  5 12  4 11 |  0  0 16  0 | 
---------------------------------------------------------
|  3 13  7 10 |  2  1  0  0 | 12  9  8  0 |  6  0 14  0 | 
| 16  0  4  0 | 11  3  6 12 |  0  0  0  1 |  5  9  8  7 | 
|  0  0  0  0 | 16  0  0  0 |  6  3  0  4 |  0 10  0  2 | 
|  1  0 14 11 |  8  9 10  0 |  0  0  5 16 |  0 13 12  4 | 
---------------------------------------------------------
|  2  0  1  5 | 12  0  0  9 |  4  0 16  0 | 15  0  7  0 | 
|  0 12  9  8 | 15  0  7  0 |  1 14  2  0 |  0  0  0 11 | 
|  0 10  0  0 |  1 14  3  0 |  0 11 13  7 |  0 12  6  0 | 
|  0 14  3  0 |  6  0 16  0 |  0  0  9  0 |  0  8  2  1 | 
---------------------------------------------------------
|  0  0 12  0 |  3  0  0  4 | 13  1  0 10 | 14 16  0  0 | 
| 11  0 13  3 |  0  7 12  0 |  0  0  0  6 |  0  5  1  8 | 
|  0  0  2  0 | 13  0  5  1 |  0  4  3  0 |  0  0  9 10 | 
| 15  1 10  0 | 14  8 11  0 |  0  0 12  9 |  0  0  4  3 | 
---------------------------------------------------------
Solved: 
---------------------------------------------------------
| 12  9  8  7 |  4  6 13  3 | 16 15 10  2 | 11  1  5 14 | 
|  5  2 11  4 |  7 12  9 16 |  3  8  1 14 | 10  6 13 15 | 
| 10 16 15  1 |  5 11  2 14 |  9  7  6 13 |  8  4  3 12 | 
| 13  3  6 14 | 10 15  1  8 |  5 12  4 11 |  7  2 16  9 | 
---------------------------------------------------------
|  3 13  7 10 |  2  1  4  5 | 12  9  8 15 |  6 11 14 16 | 
| 16 15  4  2 | 11  3  6 12 | 10 13 14  1 |  5  9  8  7 | 
|  9  8  5 12 | 16 13 14  7 |  6  3 11  4 |  1 10 15  2 | 
|  1  6 14 11 |  8  9 10 15 |  7  2  5 16 |  3 13 12  4 | 
---------------------------------------------------------
|  2 11  1  5 | 12 10  8  9 |  4  6 16  3 | 15 14  7 13 | 
|  6 12  9  8 | 15  4  7 13 |  1 14  2  5 | 16  3 10 11 | 
|  4 10 16 15 |  1 14  3  2 |  8 11 13  7 |  9 12  6  5 | 
|  7 14  3 13 |  6  5 16 11 | 15 10  9 12 |  4  8  2  1 | 
---------------------------------------------------------
|  8  5 12  9 |  3  2 15  4 | 13  1  7 10 | 14 16 11  6 | 
| 11  4 13  3 |  9  7 12 10 | 14 16 15  6 |  2  5  1  8 | 
| 14  7  2  6 | 13 16  5  1 | 11  4  3  8 | 12 15  9 10 | 
| 15  1 10 16 | 14  8 11  6 |  2  5 12  9 | 13  7  4  3 | 
---------------------------------------------------------

# test 9: creating 4x4 board on hard mode
../sudoku/sudoku create hard 4 > ../tables/hard4.txt

# test 10: solving the board made by test 9
../sudoku/sudoku solve hard 4 < ../tables/hard4.txt
Original Board: 
-----------------
|  0  1 |  0  0 | 
|  0  0 |  0  1 | 
-----------------
|  4  0 |  0  0 | 
|  0  0 |  2  0 | 
-----------------
Solved: 
-----------------
|  3  1 |  4  2 | 
|  2  4 |  3  1 | 
-----------------
|  4  2 |  1  3 | 
|  1  3 |  2  4 | 
-----------------

# INVALID INPUTS

# test 11: invalid mode
../sudoku/sudoku wrong easy
Please select a valid mode: create or solve.

# test 12: invalid difficulty
../sudoku/sudoku create wrong
Please select a valid level of difficulty: easy or hard.

# test 13: 3rd argument can only be dimension
../sudoku/sudoku create easy nonIntArg
Dimension must be a 4, 9, or 16.

# test 14: using invalid dimension
../sudoku/sudoku solve hard 10 
Dimension must be a 4, 9, or 16.

# test 15: using invalid board
../sudoku/sudoku solve easy < ../tables/invalidTable.txt
Error: format of input file is incorrect

# test 16: too many arguments
../sudoku/sudoku create easy 9 extraArg
Incorrect number of arguments. Usage: ./sudoku mode difficulty [dimensions]

# test 17: trying to solve a known invalid board
../sudoku/sudoku solve easy < ../tables/unsolvableTable.txt
5 already exists in row
5 already exists in col
5 already exists in box
Invalid board
Could not solve board
Original Board: 
5 1 6 8 4 5 7 3 2 
3 0 7 6 0 5 0 0 0 
8 0 9 7 0 0 0 6 5 
1 3 5 0 6 0 9 0 7 
4 7 2 5 9 1 0 0 6 
9 6 8 3 7 0 0 5 0 
2 5 3 1 8 6 0 7 4 
6 8 4 2 0 7 5 0 0 
7 9 1 0 5 0 6 0 8 

# VALGRIND TESTS
# test 18: checking for memory leaks on create mode
valgrind --leak-check=full --show-leak-kinds=all ../sudoku/sudoku create easy > ../tables/valgrindTable.txt
==15840== Memcheck, a memory error detector
==15840== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==15840== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info
==15840== Command: ../sudoku/sudoku create easy
==15840== 
==15840== 
==15840== HEAP SUMMARY:
==15840==     in use at exit: 0 bytes in 0 blocks
==15840==   total heap usage: 4,186 allocs, 4,186 frees, 96,914 bytes allocated
==15840== 
==15840== All heap blocks were freed -- no leaks are possible
==15840== 
==15840== For counts of detected and suppressed errors, rerun with: -v
==15840== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)


# test 19: checking for memory leaks on solve mode
valgrind --leak-check=full --show-leak-kinds=all ../sudoku/sudoku solve easy < ../tables/valgrindTable.txt
==15852== Memcheck, a memory error detector
==15852== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==15852== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info
==15852== Command: ../sudoku/sudoku solve easy
==15852== 
Original Board: 
----------------------------------
|  0  8  7 |  6  1  5 |  2  0  0 | 
|  6  1  0 |  0  4  0 |  0  7  9 | 
|  0  4  0 |  8  0  0 |  1  5  6 | 
----------------------------------
|  8  7  0 |  1  5  2 |  0  0  0 | 
|  0  2  0 |  0  0  0 |  0  8  7 | 
|  0  5  0 |  3  0  7 |  0  0  2 | 
----------------------------------
|  0  0  0 |  0  0  1 |  9  6  0 | 
|  7  9  0 |  0  0  0 |  4  0  0 | 
|  1  6  0 |  0  0  0 |  0  2  0 | 
----------------------------------
Solved: 
----------------------------------
|  9  8  7 |  6  1  5 |  2  4  3 | 
|  6  1  5 |  2  4  3 |  8  7  9 | 
|  2  4  3 |  8  7  9 |  1  5  6 | 
----------------------------------
|  8  7  6 |  1  5  2 |  3  9  4 | 
|  3  2  1 |  4  9  6 |  5  8  7 | 
|  4  5  9 |  3  8  7 |  6  1  2 | 
----------------------------------
|  5  3  4 |  7  2  1 |  9  6  8 | 
|  7  9  2 |  5  6  8 |  4  3  1 | 
|  1  6  8 |  9  3  4 |  7  2  5 | 
----------------------------------
==15852== 
==15852== HEAP SUMMARY:
==15852==     in use at exit: 0 bytes in 0 blocks
==15852==   total heap usage: 47 allocs, 47 frees, 17,338 bytes allocated
==15852== 
==15852== All heap blocks were freed -- no leaks are possible
==15852== 
==15852== For counts of detected and suppressed errors, rerun with: -v
==15852== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)


# test 20: checking for memory leaks on necessary edge cases
valgrind --leak-check=full --show-leak-kinds=all ../sudoku/sudoku solve easy < ../tables/invalidTable.txt
==15855== Memcheck, a memory error detector
==15855== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==15855== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info
==15855== Command: ../sudoku/sudoku solve easy
==15855== 
Error: format of input file is incorrect
==15855== 
==15855== HEAP SUMMARY:
==15855==     in use at exit: 0 bytes in 0 blocks
==15855==   total heap usage: 12 allocs, 12 frees, 8,604 bytes allocated
==15855== 
==15855== All heap blocks were freed -- no leaks are possible
==15855== 
==15855== For counts of detected and suppressed errors, rerun with: -v
==15855== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)


exit 0
