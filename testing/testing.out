# ETHAN CHEN, BANSHAREE IREEN, JEFFREY JIANG
# testing.sh - integration testing for sudoku module

touch ../tables/easyTable.txt
touch ../tables/hardTable.txt
touch ../tables/valgrindTable.txt
touch ../tables/easy16.txt
touch ../tables/hard16.txt
touch ../tables/hard4.txt

# VALID TESTS
# test 1:creating a board on easy mode
../sudoku/sudoku create easy > ../tables/easyTable.txt

# test 2: creating a board on hard mode
../sudoku/sudoku create hard > ../tables/hardTable.txt

# test 3: solving the board made by test 1
../sudoku/sudoku solve easy < ../tables/easyTable.txt
Original Board: 
----------------------------------
|  8  0  3 |  0  0  7 |  0  0  5 | 
|  0  0  0 |  9  3  0 |  0  8  0 | 
|  0  6  7 |  1  0  0 |  9  0  2 | 
----------------------------------
|  0  8  0 |  0  5  0 |  7  1  0 | 
|  0  7  0 |  4  0  9 |  2  0  0 | 
|  0  0  4 |  7  1  2 |  8  0  0 | 
----------------------------------
|  4  0  6 |  5  0  1 |  3  9  0 | 
|  0  0  8 |  6  2  0 |  0  7  0 | 
|  0  0  0 |  0  0  3 |  0  0  6 | 
----------------------------------
Solved: 
----------------------------------
|  8  9  3 |  2  6  7 |  1  4  5 | 
|  1  4  2 |  9  3  5 |  6  8  7 | 
|  5  6  7 |  1  4  8 |  9  3  2 | 
----------------------------------
|  2  8  9 |  3  5  6 |  7  1  4 | 
|  6  7  1 |  4  8  9 |  2  5  3 | 
|  3  5  4 |  7  1  2 |  8  6  9 | 
----------------------------------
|  4  2  6 |  5  7  1 |  3  9  8 | 
|  9  3  8 |  6  2  4 |  5  7  1 | 
|  7  1  5 |  8  9  3 |  4  2  6 | 
----------------------------------

# test 4: solving the board made by test 2
../sudoku/sudoku solve hard < ../tables/easyTable.txt
Original Board: 
----------------------------------
|  8  0  3 |  0  0  7 |  0  0  5 | 
|  0  0  0 |  9  3  0 |  0  8  0 | 
|  0  6  7 |  1  0  0 |  9  0  2 | 
----------------------------------
|  0  8  0 |  0  5  0 |  7  1  0 | 
|  0  7  0 |  4  0  9 |  2  0  0 | 
|  0  0  4 |  7  1  2 |  8  0  0 | 
----------------------------------
|  4  0  6 |  5  0  1 |  3  9  0 | 
|  0  0  8 |  6  2  0 |  0  7  0 | 
|  0  0  0 |  0  0  3 |  0  0  6 | 
----------------------------------
Solved: 
----------------------------------
|  8  9  3 |  2  6  7 |  1  4  5 | 
|  1  4  2 |  9  3  5 |  6  8  7 | 
|  5  6  7 |  1  4  8 |  9  3  2 | 
----------------------------------
|  2  8  9 |  3  5  6 |  7  1  4 | 
|  6  7  1 |  4  8  9 |  2  5  3 | 
|  3  5  4 |  7  1  2 |  8  6  9 | 
----------------------------------
|  4  2  6 |  5  7  1 |  3  9  8 | 
|  9  3  8 |  6  2  4 |  5  7  1 | 
|  7  1  5 |  8  9  3 |  4  2  6 | 
----------------------------------

# test 5: creating 16x16 on easy board 
../sudoku/sudoku create easy 16 > ../tables/easy16.txt

# test 6: creating 16x16 board on hard mode
../sudoku/sudoku create hard 16 > ../tables/hard16.txt

# test 7: solving the board made by test 5
../sudoku/sudoku solve easy 16 < ../tables/easy16.txt
Original Board: 
---------------------------------------------------------
|  1  7  2  3 | 15  5  4 16 | 12 13  0  9 |  0  8 10 11 | 
| 15  0 14  9 |  1  7  2  0 |  6  0 10 11 |  0 16  5  4 | 
|  6  5  0  0 |  0  0 10  0 |  1  0  3  0 |  0 14  0 13 | 
|  8  0 11  0 |  0 14  9  6 |  7  4  0  0 |  1  2  0  0 | 
---------------------------------------------------------
|  0  1  0  0 |  2 13  0  0 |  5  0  4 12 | 16 10 11  0 | 
|  2  0  0 13 |  3  0 15  7 |  8 10  0 14 |  5  4  6  9 | 
|  0  6  5  0 | 16  0  0  0 |  0  1  7  0 |  0 13  0  0 | 
|  0  0  8  0 |  0  0  5  4 | 15  9  0 16 |  0  0  7  3 | 
---------------------------------------------------------
|  5  2  1  0 |  0  3  0  0 |  0  0  0  4 |  0 12  0 14 | 
|  0  3 15  8 |  0  2  0  0 | 10  0  5 13 |  0  9  4  6 | 
|  0  9  0 10 | 14 11  6  5 |  0  3  0  1 |  8 15  0  0 | 
|  0  0  6  0 |  0  0 16  0 | 14  0  0  0 |  0  0  1  2 | 
---------------------------------------------------------
|  3  0  7  1 | 10  0  8 14 |  0  5  2  0 | 13  0 12  0 | 
| 11  0 10  2 |  0 15  7 13 | 16  0  0  3 |  0  0  8  1 | 
| 12  8  0  6 |  0  0  3  1 | 13 14 15 10 |  0  0  2  5 | 
|  0  0 13  5 |  0  6  0  2 | 11  7  0  8 |  0  3 15 10 | 
---------------------------------------------------------
Solved: 
---------------------------------------------------------
|  1  7  2  3 | 15  5  4 16 | 12 13 14  9 |  6  8 10 11 | 
| 15 13 14  9 |  1  7  2  3 |  6  8 10 11 | 12 16  5  4 | 
|  6  5  4 16 | 12  8 10 11 |  1  2  3 15 |  7 14  9 13 | 
|  8 10 11 12 | 13 14  9  6 |  7  4 16  5 |  1  2  3 15 | 
---------------------------------------------------------
|  7  1  3 15 |  2 13 14  9 |  5  6  4 12 | 16 10 11  8 | 
|  2 16 12 13 |  3  1 15  7 |  8 10 11 14 |  5  4  6  9 | 
|  9  6  5  4 | 16 10 11  8 |  3  1  7  2 | 15 13 14 12 | 
| 10 11  8 14 |  6 12  5  4 | 15  9 13 16 |  2  1  7  3 | 
---------------------------------------------------------
|  5  2  1  7 |  8  3 13 15 |  9 11  6  4 | 10 12 16 14 | 
| 14  3 15  8 |  7  2  1 12 | 10 16  5 13 | 11  9  4  6 | 
|  4  9 16 10 | 14 11  6  5 |  2  3 12  1 |  8 15 13  7 | 
| 13 12  6 11 |  9  4 16 10 | 14 15  8  7 |  3  5  1  2 | 
---------------------------------------------------------
|  3 15  7  1 | 10  9  8 14 |  4  5  2  6 | 13 11 12 16 | 
| 11  4 10  2 |  5 15  7 13 | 16 12  9  3 | 14  6  8  1 | 
| 12  8  9  6 | 11 16  3  1 | 13 14 15 10 |  4  7  2  5 | 
| 16 14 13  5 |  4  6 12  2 | 11  7  1  8 |  9  3 15 10 | 
---------------------------------------------------------

# test 8: solving the board made by test 6
../sudoku/sudoku solve hard 16 < ../tables/hard16.txt
Original Board: 
---------------------------------------------------------
|  0  7  2  3 | 15  5  4 16 | 12 13  0  9 |  0  8 10 11 | 
| 15  0 14  9 |  1  7  2  0 |  6  0 10 11 |  0 16  5  4 | 
|  6  5  0  0 |  0  0 10  0 |  1  0  3  0 |  0 14  0 13 | 
|  8  0 11  0 |  0 14  0  6 |  7  4  0  0 |  1  2  0  0 | 
---------------------------------------------------------
|  0  1  0  0 |  2 13  0  0 |  5  0  4  0 | 16 10 11  0 | 
|  2  0  0 13 |  3  0 15  7 |  8  0  0  0 |  5  4  6  9 | 
|  0  6  5  0 | 16  0  0  0 |  0  1  7  0 |  0 13  0  0 | 
|  0  0  8  0 |  0  0  5  4 | 15  9  0  0 |  0  0  7  3 | 
---------------------------------------------------------
|  0  2  1  0 |  0  3  0  0 |  0  0  0  4 |  0  0  0 14 | 
|  0  3 15  8 |  0  2  0  0 | 10  0  5 13 |  0  9  4  6 | 
|  0  9  0 10 | 14 11  6  5 |  0  3  0  1 |  8 15  0  0 | 
|  0  0  6  0 |  0  0 16  0 | 14  0  0  0 |  0  0  0  2 | 
---------------------------------------------------------
|  0  0  7  1 | 10  0  8 14 |  0  5  2  0 | 13  0 12  0 | 
|  0  0 10  2 |  0  0  7 13 | 16  0  0  3 |  0  0  8  1 | 
| 12  8  0  6 |  0  0  3  1 | 13 14 15 10 |  0  0  0  0 | 
|  0  0  0  5 |  0  6  0  2 | 11  7  0  8 |  0  3 15 10 | 
---------------------------------------------------------
Solved: 
---------------------------------------------------------
|  1  7  2  3 | 15  5  4 16 | 12 13 14  9 |  6  8 10 11 | 
| 15 13 14  9 |  1  7  2  3 |  6  8 10 11 | 12 16  5  4 | 
|  6  5  4 16 | 12  8 10 11 |  1  2  3 15 |  7 14  9 13 | 
|  8 10 11 12 | 13 14  9  6 |  7  4 16  5 |  1  2  3 15 | 
---------------------------------------------------------
|  7  1  3 15 |  2 13 14  9 |  5  6  4 12 | 16 10 11  8 | 
|  2 16 12 13 |  3  1 15  7 |  8 10 11 14 |  5  4  6  9 | 
|  9  6  5  4 | 16 10 11  8 |  3  1  7  2 | 15 13 14 12 | 
| 10 11  8 14 |  6 12  5  4 | 15  9 13 16 |  2  1  7  3 | 
---------------------------------------------------------
|  5  2  1  7 |  8  3 13 15 |  9 11  6  4 | 10 12 16 14 | 
| 14  3 15  8 |  7  2  1 12 | 10 16  5 13 | 11  9  4  6 | 
|  4  9 16 10 | 14 11  6  5 |  2  3 12  1 |  8 15 13  7 | 
| 13 12  6 11 |  9  4 16 10 | 14 15  8  7 |  3  5  1  2 | 
---------------------------------------------------------
|  3 15  7  1 | 10  9  8 14 |  4  5  2  6 | 13 11 12 16 | 
| 11  4 10  2 |  5 15  7 13 | 16 12  9  3 | 14  6  8  1 | 
| 12  8  9  6 | 11 16  3  1 | 13 14 15 10 |  4  7  2  5 | 
| 16 14 13  5 |  4  6 12  2 | 11  7  1  8 |  9  3 15 10 | 
---------------------------------------------------------

# test 9: creating 4x4 board on hard mode
../sudoku/sudoku create hard 4 > ../tables/hard4.txt

# test 10: solving the board made by test 9
../sudoku/sudoku solve hard 4 < ../tables/hard4.txt
Original Board: 
-----------------
|  1  0 |  0  0 | 
|  0  0 |  0  4 | 
-----------------
|  3  1 |  0  0 | 
|  0  0 |  0  0 | 
-----------------
Solved: 
-----------------
|  1  4 |  2  3 | 
|  2  3 |  1  4 | 
-----------------
|  3  1 |  4  2 | 
|  4  2 |  3  1 | 
-----------------

# INVALID INPUTS

# invalid mode
../sudoku/sudoku wrong easy
Please select a valid mode: create or solve.

# invalid difficulty
../sudoku/sudoku create wrong
Please select a valid level of difficulty: easy or hard.

# 3rd argument can only be dimension
../sudoku/sudoku create easy nonIntArg
Dimension must be a 4, 9, or 16.

# using invalid dimension
../sudoku/sudoku solve hard 10 
Dimension must be a 4, 9, or 16.

# using invalid board
../sudoku/sudoku solve easy < ../tables/invalidTable.txt
Error: format of input file is incorrect

# SOLVABILITY
# trying to solve a known unsolvable board
../sudoku/sudoku solve easy < ../tables/unsolvableTable.txt
5 already exists in row
5 already exists in col
5 already exists in box
Invalid board
Could not solve board
Original Board: 
5 1 6 8 4 5 7 3 2 
3 0 7 6 0 5 0 0 0 
8 0 9 7 0 0 0 6 5 
1 3 5 0 6 0 9 0 7 
4 7 2 5 9 1 0 0 6 
9 6 8 3 7 0 0 5 0 
2 5 3 1 8 6 0 7 4 
6 8 4 2 0 7 5 0 0 
7 9 1 0 5 0 6 0 8 

# VALGRIND TESTS
# checking for memory leaks on create mode
valgrind --leak-check=full --show-leak-kinds=all ../sudoku/sudoku create easy > ../tables/valgrindTable.txt
==35395== Memcheck, a memory error detector
==35395== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==35395== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info
==35395== Command: ../sudoku/sudoku create easy
==35395== 
==35395== 
==35395== HEAP SUMMARY:
==35395==     in use at exit: 0 bytes in 0 blocks
==35395==   total heap usage: 4,096 allocs, 4,096 frees, 95,006 bytes allocated
==35395== 
==35395== All heap blocks were freed -- no leaks are possible
==35395== 
==35395== For counts of detected and suppressed errors, rerun with: -v
==35395== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)

# checking for memory leaks on solve mode
valgrind --leak-check=full --show-leak-kinds=all ../sudoku/sudoku solve easy < ../tables/valgrindTable.txt
==35427== Memcheck, a memory error detector
==35427== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==35427== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info
==35427== Command: ../sudoku/sudoku solve easy
==35427== 
Original Board: 
----------------------------------
|  0  4  2 |  0  0  0 |  0  0  0 | 
|  0  0  0 |  1  8  0 |  2  4  0 | 
|  7  0  8 |  0  4  9 |  0  0  0 | 
----------------------------------
|  0  0  0 |  4  6  0 |  0  7  0 | 
|  4  8  0 |  7  9  3 |  1  0  6 | 
|  9  7  6 |  8  0  1 |  0  5  3 | 
----------------------------------
|  0  0  4 |  0  0  8 |  0  0  0 | 
|  0  0  0 |  6  1  0 |  5  0  0 | 
|  0  2  3 |  0  7  0 |  9  8  0 | 
----------------------------------
Solved: 
----------------------------------
|  1  4  2 |  3  5  7 |  6  9  8 | 
|  3  5  9 |  1  8  6 |  2  4  7 | 
|  7  6  8 |  2  4  9 |  3  1  5 | 
----------------------------------
|  2  3  1 |  4  6  5 |  8  7  9 | 
|  4  8  5 |  7  9  3 |  1  2  6 | 
|  9  7  6 |  8  2  1 |  4  5  3 | 
----------------------------------
|  5  1  4 |  9  3  8 |  7  6  2 | 
|  8  9  7 |  6  1  2 |  5  3  4 | 
|  6  2  3 |  5  7  4 |  9  8  1 | 
----------------------------------
==35427== 
==35427== HEAP SUMMARY:
==35427==     in use at exit: 0 bytes in 0 blocks
==35427==   total heap usage: 47 allocs, 47 frees, 17,338 bytes allocated
==35427== 
==35427== All heap blocks were freed -- no leaks are possible
==35427== 
==35427== For counts of detected and suppressed errors, rerun with: -v
==35427== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)

# checking for memory leaks on necessary edge cases
valgrind --leak-check=full --show-leak-kinds=all ../sudoku/sudoku solve easy < ../tables/invalidTable.txt
==35440== Memcheck, a memory error detector
==35440== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
==35440== Using Valgrind-3.13.0 and LibVEX; rerun with -h for copyright info
==35440== Command: ../sudoku/sudoku solve easy
==35440== 
Error: format of input file is incorrect
==35440== 
==35440== HEAP SUMMARY:
==35440==     in use at exit: 0 bytes in 0 blocks
==35440==   total heap usage: 12 allocs, 12 frees, 8,604 bytes allocated
==35440== 
==35440== All heap blocks were freed -- no leaks are possible
==35440== 
==35440== For counts of detected and suppressed errors, rerun with: -v
==35440== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)

exit 0
